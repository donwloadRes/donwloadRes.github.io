---
layout: post
title: "CVE-2023-38831 WinRAR代码执行漏洞复现资源文件"
date:   2020-11-23
tags: [文件,漏洞,WinRAR,test,png]
comments: true
author: admin
---
# CVE-2023-38831 WinRAR代码执行漏洞复现资源文件

## 简介

本资源文件提供了关于CVE-2023-38831漏洞的复现材料，该漏洞影响WinRAR软件的早期版本（< 6.23）。通过本资源文件，用户可以了解如何利用该漏洞进行代码执行攻击，并学习如何防范此类攻击。

## 漏洞概述

WinRAR是一款广泛使用的文件压缩管理工具，支持RAR、ZIP等多种压缩格式。CVE-2023-38831漏洞存在于WinRAR处理压缩包内同名文件与文件夹的过程中。攻击者可以构建包含恶意文件与非恶意文件的特制压缩包，诱导受害者打开该文件后，在受害者机器上执行任意代码。

## 影响范围

- WinRAR < 6.23

## 复现步骤

1. **启动Kali虚拟机**：将`nc64.exe`上传到虚拟机中相应的目录下。
2. **启动HTTP服务监听**：执行以下代码启动HTTP服务监听，让受害者的机器可以下载该程序。
   ```bash
   python -m http.server
   ```
3. **启动端口监听**：在Kali机器上打开新的终端，执行以下代码启动端口监听。
   ```bash
   nc -lnvp 4444
   ```
4. **制作POC文件**：使用提供的利用脚本或现成的漏洞环境，制作名为`poc.zip`的利用文件。
5. **触发漏洞**：在存在漏洞的WinRAR版本中打开POC文件，双击普通文件，漏洞触发。

## 漏洞原理

当受害者尝试打开存档文件中的"test.png"时，WinRAR会比较存档中的所有文件以查找与"test.png"同名的文件/目录。如果存在与"test.png"同名的目录，WinRAR则会继续检查"test.png/"目录下的文件。如果"test.png/"目录下同样存在文件名为"test.png"的文件，则将"test.png/"目录下"test.png"文件放入提取列表中，最终导致压缩包中的`test.png.cmd`被解压并运行。

## 漏洞修复

将WinRAR软件版本更新至最新版本即可修复该漏洞。

## 注意事项

- 本资源文件仅供学习和研究使用，请勿用于非法用途。
- 使用本资源文件进行实验时，请确保在受控环境中进行，避免对他人造成影响。

## 参考资料

- [CVE-2023-38831 WinRAR 逻辑漏洞原因分析](https://blog.csdn.net/qq_64973687/article/details/134069211)

---

通过本资源文件，用户可以深入了解CVE-2023-38831漏洞的原理和复现过程，提升对网络安全漏洞的认识和防范能力。

## 下载链接

[CVE-2023-38831WinRAR代码执行漏洞复现资源文件](https://pan.quark.cn/s/a50356d7542f)