---
layout: post
title: "STM32F407 TIMERDMADAC自制简易示波器"
date:   2024-08-26
tags: [触发,ADC,波形,DMA,功能]
comments: true
author: admin
---
# STM32F407 TIMER+DMA+DAC自制简易示波器

## 项目描述

本项目基于正点原子STM32F407探索者开发板，通过TIMER3触发DMA+DAC波形数据采集，并使用TFT屏幕显示波形，实现了一个简易的示波器功能。以下是项目的主要特点和功能：

### 主要功能

1. **高采样率**：
   - 最高采样率可达500kHz。
   - 定时器每两微秒触发一次ADC转换（在168MHz时钟下，ADC转换速度还有提升空间，但目前暂时无法进一步提高）。

2. **波形显示**：
   - 定时器3触发ADC转换，DMA读取数据并通过DMA中断刷新波形。
   - 刷点频率可达60Hz以上，刷线频率约为26Hz。

3. **操作控制**：
   - 使用KEY_UP键进行运行/停止状态切换。
   - KEY1和KEY2键分别用于增加和减小功能。
   - KEY2键还可用于时基和触发电平的选择。
   - PF9引脚用于DMA中断指示，PF10引脚用于主程序运行指示。
   - PA5引脚用于ADC数据输入。

4. **触发功能**：
   - 稳定波形显示使用触发功能，触发点设置为屏幕中心，下降沿触发。
   - 测频功能通过计算两个下降沿之间的间隔时间实现。

### 项目现状

尽管本项目已经实现了基本的示波器功能，但仍存在许多关键问题需要解决。对于开发者来说，改进空间非常大。

## 使用说明

1. **硬件准备**：
   - 正点原子STM32F407探索者开发板。
   - TFT屏幕。
   - 其他必要的硬件连接（如按键、指示灯等）。

2. **软件配置**：
   - 配置TIMER3以实现定时触发ADC转换。
   - 配置DMA以读取ADC数据并刷新波形。
   - 配置TFT屏幕以显示波形。

3. **操作步骤**：
   - 通过按键进行运行/停止状态切换。
   - 使用KEY1和KEY2键调整时基和触发电平。
   - 观察TFT屏幕上的波形显示。

## 未来改进方向

1. **提高ADC转换速度**：
   - 进一步优化定时器和ADC配置，提高采样率。

2. **优化波形刷新频率**：
   - 改进DMA中断处理，提高刷点频率和刷线频率。

3. **增强触发功能**：
   - 支持更多触发模式（如上升沿触发、双边沿触发等）。

4. **改进测频功能**：
   - 提高测频精度，支持更多频率范围的测量。

## 致谢

感谢正点原子提供的STM32F407探索者开发板，为本项目的实现提供了硬件基础。

## 联系我们

如有任何问题或建议，欢迎通过邮件或GitHub Issues联系我们。

## 下载链接

[STM32F407TIMERDMADAC自制简易示波器](https://pan.quark.cn/s/7ebd99f8ac38)