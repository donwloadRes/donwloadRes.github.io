---
layout: post
title: "文件上传漏洞详解"
date:   2023-07-26
tags: [上传,文件,漏洞,解析,绕过]
comments: true
author: admin
---
# 文件上传漏洞详解

## 简介
本仓库提供了一个关于文件上传漏洞的详细解析资源文件。文件上传漏洞是Web系统中常见的一种功能，通过文件上传能实现上传图片、视频以及其他类型的文件。然而，随着Web中包含的功能越来越多，潜在的网络安全风险也就越大。如果恶意用户上传了可执行的文件或者脚本，就会导致网站被其控制甚至会使其服务器沦陷，以至于引发恶意的网络安全事件。

## 文件上传漏洞原理
文件上传漏洞是指用户通过界面上的上传功能上传了一个可执行的脚本文件，而WEB端的系统并未对其进行检测或者检测的逻辑做的不够好。通过来说文件上传功能是没有问题的，主要是服务器如何对上传的文件如何进行处理。若WEB未对用户上传的文件进行有效的审查，若存在恶意用户对其上传一句话木马，从而实现控制WEB网站的目的。

## 文件上传思路
1. **常规类**：扫描获取上传、会员中心头像上传、后台系统上传、其他途径上传。
2. **CMS类**：已知道的CMS源码。
3. **编辑类**：ckeditor、fckeditor、kindeditor、xxxxeditor。
4. **其他类/CVE**：代码审计、平台或第三方应用。

## Web界面存在的风险点
上传头像、上传身份认证、上传文件以及有存在文件上传的地方就可能存在相关的漏洞，但不是有文件上传就一定有漏洞，但有文件上传就能进行测试。

## 文件上传实战思路
上传文件和文件执行是两个东西。漏洞分类：解析漏洞、CMS漏洞、其他漏洞（编辑器漏洞、CVE漏洞、安全修复）。

## 文件上传绕过分类
1. **JS类防护**：前端验证。
2. **黑名单**：特殊解析后缀、htaccess解析、大小写绕过、点绕过、空格绕过、::$$DATA绕过、配合解析漏洞、双后缀名绕过。
3. **白名单**：MIME绕过、%00截断。
4. **内容及其他**：文件头检测、二次渲染、条件竞争、突破getimagesize、突破exif_imagetype。

## 解析漏洞
解析漏洞是指服务器应用程序在解析某些精心构造的后缀文件的时候，会将相关的文件解析成网页的脚本，从而导致实现控制网站，同时大部分的解析漏洞都是由应用程序产生的。

## 编辑器漏洞
编辑器也就是在线的Web编辑器，比如在搭建博客后需要发布文章，那么用来发布文章的界面就是Web编辑器。常见的Web编辑器有UEDITOR（百度）、eWebEdit、FCKeditor、CKEditor（新版fck）、Kindeditor、DotNetTextBox、CuteEditor等。

## WAF绕过
WAF绕过其实就是将数据包截获到，对里面的内容进行解析，比如对文件的后缀名就判断是否在相应的黑名单中，文件内容中是否存在webshell代码。总的来说文件上传都是在数据包中进行各种操作来进行绕过。

## 安全修复
文件上传修复是防止文件上传漏洞的关键。可以通过限制上传目录的执行权限、不允许创建目录、上传的文件进行重命名等方式来修复漏洞。

---

通过本资源文件，您可以深入了解文件上传漏洞的原理、分类、绕过方法以及安全修复措施，帮助您在实际应用中更好地防范此类安全风险。

## 下载链接

[文件上传漏洞详解](https://pan.quark.cn/s/49948e0baa5b)